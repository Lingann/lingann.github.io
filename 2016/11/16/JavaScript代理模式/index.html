<!DOCTYPE html>
<html>
<head><meta name="generator" content="Hexo 3.9.0">
  <meta charset="utf-8">
  
  <title>JavaScript代理模式 | Lingann</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="代理模式代理模式是为一个对象提供一个代用品或占位符，以便控制对它的访问 代理和本体接口 接口:在TypeScript里，接口的作用就是为这些类型命名和为你的代码或第三方代码定义契约。 接口一致代理对象角色内部含有对真实对象的引用，从而可以操作真实对象，同时代理对象提供与真实对象相同的接口以便在任何时刻都能代替真实对象 如果代理对象和本体对象都为一个函数(函数也是对象)，函数必然都能被执行，则可以认">
<meta name="keywords" content="设计模式">
<meta property="og:type" content="article">
<meta property="og:title" content="JavaScript代理模式">
<meta property="og:url" content="http://yoursite.com/2016/11/16/JavaScript代理模式/index.html">
<meta property="og:site_name" content="Lingann">
<meta property="og:description" content="代理模式代理模式是为一个对象提供一个代用品或占位符，以便控制对它的访问 代理和本体接口 接口:在TypeScript里，接口的作用就是为这些类型命名和为你的代码或第三方代码定义契约。 接口一致代理对象角色内部含有对真实对象的引用，从而可以操作真实对象，同时代理对象提供与真实对象相同的接口以便在任何时刻都能代替真实对象 如果代理对象和本体对象都为一个函数(函数也是对象)，函数必然都能被执行，则可以认">
<meta property="og:locale" content="zh-CN">
<meta property="og:updated_time" content="2019-10-23T08:33:40.687Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="JavaScript代理模式">
<meta name="twitter:description" content="代理模式代理模式是为一个对象提供一个代用品或占位符，以便控制对它的访问 代理和本体接口 接口:在TypeScript里，接口的作用就是为这些类型命名和为你的代码或第三方代码定义契约。 接口一致代理对象角色内部含有对真实对象的引用，从而可以操作真实对象，同时代理对象提供与真实对象相同的接口以便在任何时刻都能代替真实对象 如果代理对象和本体对象都为一个函数(函数也是对象)，函数必然都能被执行，则可以认">
  
    <link rel="alternative" href="/atom.xml" title="Lingann" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.png">
  
  <link href="//fonts.googleapis.com/css?family=Source+Code+Pro" rel="stylesheet" type="text/css">
  <link rel="stylesheet" href="/css/style.css">
  

</head></html>
<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">Lingann</a>
      </h1>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
      </nav>
      <nav id="sub-nav">
        
          <a id="nav-rss-link" class="nav-icon" href="/atom.xml" title="RSS Feed"></a>
        
        <a id="nav-search-btn" class="nav-icon" title="Search"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="http://yoursite.com"></form>
      </div>
    </div>
  </div>
</header>
      <div class="outer">
        <section id="main"><article id="[layout]-JavaScript代理模式" class="article article-type-[layout]" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2016/11/16/JavaScript代理模式/" class="article-date">
  <time datetime="2016-11-16T13:13:23.000Z" itemprop="datePublished">2016-11-16</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/JavaScript/">JavaScript</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 class="article-title" itemprop="name">
      JavaScript代理模式
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h2 id="代理模式"><a href="#代理模式" class="headerlink" title="代理模式"></a>代理模式</h2><p>代理模式是为一个对象提供一个代用品或占位符，以便控制对它的访问</p>
<h3 id="代理和本体"><a href="#代理和本体" class="headerlink" title="代理和本体"></a>代理和本体</h3><h4 id="接口"><a href="#接口" class="headerlink" title="接口"></a>接口</h4><p> 接口:在TypeScript里，接口的作用就是为这些类型命名和为你的代码或第三方代码定义契约。</p>
<h4 id="接口一致"><a href="#接口一致" class="headerlink" title="接口一致"></a>接口一致</h4><p>代理对象角色内部含有对真实对象的引用，从而可以操作真实对象，同时代理对象提供与真实对象相同的接口以便在任何时刻都能代替真实对象</p>
<p>如果代理对象和本体对象都为一个函数(函数也是对象)，函数必然都能被执行，则可以认为它们也具有一致的”接口”</p>
<h4 id="互不影响，相互独立"><a href="#互不影响，相互独立" class="headerlink" title="互不影响，相互独立"></a>互不影响，相互独立</h4><p>虽然代理和本体都有一致的接口，但代理并不会影响本体。实际上，他们控制的都是接口对应的参数，代理不会让本体通过接口去改变参数，本体同样也不会让代理这么干，因为他们各自本身都可以改变接口参数。</p>
<p>代理和本体的一个重要区别是，代理对象可以访问本体对象，而本体对象却不能反过来访问代理。</p>
<p>在任何使用本体的地方都可以替换成使用代理，如果不想使用代理，那就让客户事件直接调用本体就可以了，不用经过代理对象。</p>
<h3 id="代理模式分类"><a href="#代理模式分类" class="headerlink" title="代理模式分类"></a>代理模式分类</h3><ul>
<li>保护代理<br>  用于对象应该有不同访问权限的情况</li>
<li>虚拟代理<br>  虚拟代理把一些开销很大的对象，延迟到真正需要它的时候去创建</li>
<li>缓存代理<br>  缓存代理可以为一些开销大的运算结果提供暂时的存储，在下次运算时，如果传递进来的参数跟之前一致，则可以直接返回前面存储的运算结果</li>
<li>防火墙代理<br>  控制网络资源的访问，保护主题不让”坏人”接近</li>
<li>远程代理<br>  为一个对象在不同的地址空间提供局部代表，在Java代理可以是另一个虚拟机中的对象</li>
<li>智能引用代理<br>  取代了简单的指针，它在访问对象时执行一些附加操作，比如计算一个对象被引用的次数</li>
<li>写时复制代理<br>  常用于复制一个庞大对象的情况。写时复制代理延迟了复制的过程，当对象被真正修改时，才对它进行复制操作。写时复制代理是虚拟代理的一种变体，DLL(操作系统中的动态链接库)是其典型运用场景</li>
</ul>
<h3 id="JavaScript中的代理模式"><a href="#JavaScript中的代理模式" class="headerlink" title="JavaScript中的代理模式"></a>JavaScript中的代理模式</h3><p>代理模式有许多分类，在JavaScript开发中最常用的是虚拟代理和缓存代理。</p>
<p>虽然代理模式非常有用，但在编写业务代码的时候，往往不需要去预先猜测是否需要使用代理模式。当真正发现不方便直接访问某个对象的时候，再编写代理也不迟。</p>
<h3 id="虚拟代理"><a href="#虚拟代理" class="headerlink" title="虚拟代理"></a>虚拟代理</h3><h4 id="【情景1】-图片预加载"><a href="#【情景1】-图片预加载" class="headerlink" title="【情景1】 图片预加载"></a>【情景1】 图片预加载</h4><ul>
<li>原因<br>网速较慢时，客户在等待图片加载的时候，页面没有交互，将影响用户体验</li>
<li>机制<br>先用一张loading图片占位，然后用异步的方式加载图片，等图片加载好了，再把它填充到img节点里</li>
<li><p>原理</p>
<ol>
<li>创建普通本体对象，负责往页面中创建img标签，并提供一个对外的setSrc接口，外界调用这个接口，便可以给img标签设置src属性。</li>
<li>引入代理对象proxyImage，通过这个代理对象，可以间接访问本体对象，在图片真正被加载好之前，把imgsrc节点设置为一张loading图片。</li>
<li>客户事件，客户通过调用代理对象从而间接访问本体对象。</li>
</ol>
</li>
<li><p>源码</p>
<iframe width="100%" height="600" src="//jsfiddle.net/Lingann/2we1k4ct/embedded/" allowfullscreen="allowfullscreen" frameborder="0">

</iframe></li>
</ul>
<h4 id="【情景2】-虚拟代理合并Http中的应用——文件同步"><a href="#【情景2】-虚拟代理合并Http中的应用——文件同步" class="headerlink" title="【情景2】 虚拟代理合并Http中的应用——文件同步"></a>【情景2】 虚拟代理合并Http中的应用——文件同步</h4><ul>
<li>原因<br>当用户频繁的进行网络请求，将会对服务器产生相当大的开销。通过一点延迟，将能够大大减轻服务器压力</li>
<li>机制<br>收集一段时间之内的网络请求，最后一次性发给服务器</li>
<li><p>原理</p>
<ol>
<li>创建本体对象，负责进行网络请求</li>
<li>创建代理对象，负责收集一段时间之内的请求，然后在将这段时间内的请求传递给本体对象，    最后一次性发送给服务器。</li>
<li>客户事件，通过调用代理对象，进行网络请求</li>
</ol>
</li>
<li><p>源码</p>
<iframe width="100%" height="600" src="//jsfiddle.net/Lingann/s0qm54js/embedded/" allowfullscreen="allowfullscreen" frameborder="0">

</iframe></li>
</ul>
<h3 id="缓存代理"><a href="#缓存代理" class="headerlink" title="缓存代理"></a>缓存代理</h3><h4 id="【情景1】计算乘积"><a href="#【情景1】计算乘积" class="headerlink" title="【情景1】计算乘积"></a>【情景1】计算乘积</h4><ul>
<li>原因<br>当用户进行同样一次操作时，可以把上次操作的结果直接调用，更快的响应。</li>
<li>机制<br>缓存代理可以为一些开销大的运算结果提供暂时的存储，在下次运算时，如果传递进来的参数跟之前一致，则可以直接返回前面存储的运算结果</li>
<li><p>原理</p>
<ol>
<li>创建本体对象，负责计算出结果</li>
<li>创建代理对象，负责储存结果，以及输出储存的结果；如果没有储存结果，则调用本体对象，让本体对象进行计算结果，然后储存结果</li>
<li>客户事件，调用代理</li>
</ol>
</li>
<li><p>源码</p>
<iframe width="100%" height="450" src="//jsfiddle.net/Lingann/hbrz53v5/embedded/" allowfullscreen="allowfullscreen" frameborder="0"></iframe>

</li>
</ul>
<h4 id="【情景2】-缓存代理用于Ajax异步请求数据"><a href="#【情景2】-缓存代理用于Ajax异步请求数据" class="headerlink" title="【情景2】 缓存代理用于Ajax异步请求数据"></a>【情景2】 缓存代理用于Ajax异步请求数据</h4><ul>
<li>原因<br>当用户进行同样一次操作时，可以把上次操作的数据直接调用，更快的响应。</li>
<li>机制<br>我们在常常在项目中遇到分页的需求，同一页的数据理论上只需要去后台拉取一次，这些已<br>经拉取到的数据在某个地方被缓存之后，下次再请求同一页的时候，便可以直接使用之前的数据。<br>显然这里也可以引入缓存代理，实现方式跟计算乘积的例子差不多，唯一不同的是，请求数<br>据是个异步的操作，我们无法直接把计算结果放到代理对象的缓存中，而是要通过回调的方式</li>
</ul>
<h4 id="【情景3】-用高阶函数动态创建代理"><a href="#【情景3】-用高阶函数动态创建代理" class="headerlink" title="【情景3】 用高阶函数动态创建代理"></a>【情景3】 用高阶函数动态创建代理</h4><ul>
<li>源码<iframe width="100%" height="450" src="//jsfiddle.net/Lingann/fvw89g73/embedded/" allowfullscreen="allowfullscreen" frameborder="0">

</iframe></li>
</ul>
<h3 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h3><ul>
<li><a href="http://www.ituring.com.cn/book/1632" target="_blank" rel="noopener">JavaScript设计模式与开发实践</a></li>
<li><a href="http://www.cnblogs.com/bigbearbb/p/4184240.html" target="_blank" rel="noopener">大熊君说说JS与设计模式之——代理模式Proxy</a></li>
</ul>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2016/11/16/JavaScript代理模式/" data-id="ck246hcd00004g4mlviyzpo27" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/设计模式/">设计模式</a></li></ul>

    </footer>
  </div>
  
    
<nav id="article-nav">
  
    <a href="/2016/11/17/JavaScript迭代器模式/" id="article-nav-newer" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Newer</strong>
      <div class="article-nav-title">
        
          JavaScript迭代器模式
        
      </div>
    </a>
  
  
    <a href="/2016/11/14/JavaScript策略模式/" id="article-nav-older" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Older</strong>
      <div class="article-nav-title">JavaScript策略模式</div>
    </a>
  
</nav>

  
</article>

</section>
        
          <aside id="sidebar">
  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Categories</h3>
    <div class="widget">
      <ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/JavaScript/">JavaScript</a><span class="category-list-count">4</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/数据结构与算法/">数据结构与算法</a><span class="category-list-count">1</span></li></ul>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tags</h3>
    <div class="widget">
      <ul class="tag-list"><li class="tag-list-item"><a class="tag-list-link" href="/tags/推荐/">推荐</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/教程/">教程</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/设计模式/">设计模式</a><span class="tag-list-count">4</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/音乐/">音乐</a><span class="tag-list-count">1</span></li></ul>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tag Cloud</h3>
    <div class="widget tagcloud">
      <a href="/tags/推荐/" style="font-size: 10px;">推荐</a> <a href="/tags/教程/" style="font-size: 10px;">教程</a> <a href="/tags/设计模式/" style="font-size: 20px;">设计模式</a> <a href="/tags/音乐/" style="font-size: 10px;">音乐</a>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Archives</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/10/">十月 2019</a><span class="archive-list-count">3</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/11/">十一月 2016</a><span class="archive-list-count">6</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/12/">十二月 2015</a><span class="archive-list-count">2</span></li></ul>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Recents</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2019/10/23/hexo博客建站/">Hexo博客</a>
          </li>
        
          <li>
            <a href="/2019/10/23/hello-world/">Hello World</a>
          </li>
        
          <li>
            <a href="/2019/10/23/新建文本文档/">(no title)</a>
          </li>
        
          <li>
            <a href="/2016/11/23/JavaScript和css动画/">JavaScript和css动画</a>
          </li>
        
          <li>
            <a href="/2016/11/18/循环、遍历、迭代、递归、回调/">循环、遍历、迭代、递归、回调</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      &copy; 2019 Lingann<br>
      Powered by <a href="http://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>
    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
</nav>
    

<script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>


  <link rel="stylesheet" href="/fancybox/jquery.fancybox.css">
  <script src="/fancybox/jquery.fancybox.pack.js"></script>


<script src="/js/script.js"></script>

  </div>
</body>
</html>